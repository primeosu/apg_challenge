<div class="box">
  <div class="box-header">
    <span class="fa fa-database fa-fw fa-lg box-icon"></span>
    <h1>Malware</h1>
  </div>
  <div id="malware-content" class="box-content">

    <% if (malwares.length) { %>
      <h1>Known Malware</h1>
      <h2 id="malware-page-loading" class="hidden">Loading...</h2>

      <div class="table-wrapper">
        <table id="malware-table" class="table table-bordered">
          <thead>
            <tr>
              <th>
                <div class="row">
                  <div class="col-xs-11">
                    <span>MD5</span>
                  </div>
                  <div class="col-xs-1 text-right">
                    <a class="sort-link" href="#" data-key="md5">
                      <% if (malwares.sortMethod.key === 'md5') { %>
                        <span class="fa <%- (malwares.sortMethod.direction > 0) ? 'fa-sort-up' : 'fa-sort-down' %> sort-icon"></span>
                      <% } else { %>
                        <span class="fa fa-sort sort-icon"></span>
                      <% } %>
                    </a>
                  </div>
                </div>
              </th>
              <th>
                <div class="row">
                  <div class="col-xs-11">
                    <span>Classification Name</span>
                  </div>
                  <div class="col-xs-1 text-right">
                    <a class="sort-link" href="#" data-key="classificationName">
                      <% if (malwares.sortMethod.key === 'classificationName') { %>
                        <span class="fa <%- (malwares.sortMethod.direction > 0) ? 'fa-sort-up' : 'fa-sort-down' %> sort-icon"></span>
                      <% } else { %>
                        <span class="fa fa-sort sort-icon"></span>
                      <% } %>
                    </a>
                  </div>
                </div>
              </th>
              <th>
                <div class="row">
                  <div class="col-xs-11">
                    <span>Classification Type</span>
                  </div>
                  <div class="col-xs-1 text-right">
                    <a class="sort-link" href="#" data-key="classificationType">
                      <% if (malwares.sortMethod.key === 'classificationType') { %>
                        <span class="fa <%- (malwares.sortMethod.direction > 0) ? 'fa-sort-up' : 'fa-sort-down' %> sort-icon"></span>
                      <% } else { %>
                        <span class="fa fa-sort sort-icon"></span>
                      <% } %>
                    </a>
                  </div>
                </div>
              </th>
              <th>
                <div class="row">
                  <div class="col-xs-11">
                    <span>File Size</span>
                  </div>
                  <div class="col-xs-1 text-right">
                    <a class="sort-link" href="#" data-key="fileSize">
                      <% if (malwares.sortMethod.key === 'fileSize') { %>
                        <span class="fa <%- (malwares.sortMethod.direction > 0) ? 'fa-sort-up' : 'fa-sort-down' %> sort-icon"></span>
                      <% } else { %>
                        <span class="fa fa-sort sort-icon"></span>
                      <% } %>
                    </a>
                  </div>
                </div>
              </th>
              <th>
                <div class="row">
                  <div class="col-xs-11">
                    <span>File Type</span>
                  </div>
                  <div class="col-xs-1 text-right">
                    <a class="sort-link" href="#" data-key="fileType">
                      <% if (malwares.sortMethod.key === 'fileType') { %>
                        <span class="fa <%- (malwares.sortMethod.direction > 0) ? 'fa-sort-up' : 'fa-sort-down' %> sort-icon"></span>
                      <% } else { %>
                        <span class="fa fa-sort sort-icon"></span>
                      <% } %>
                    </a>
                  </div>
                </div>
              </th>
            </tr>
          </thead>
          <tbody>
            <% _.each(malwares.models, function (malware) { %>
              <tr>
                <td><%- malware.get('md5') %></td>
                <td><%- malware.get('classificationName') %></td>
                <td><%- malware.get('classificationType') %></td>
                <td><%- malware.get('fileSize') %></td>
                <td><%- malware.get('fileType') %></td>
              </tr>
            <% }); %>
          </tbody>
        </table>
      <% } else { %>
        <div id="no-malwares-wrapper">
          <div id="no-malwares-vertical-align"></div>
          <div id="no-malwares" class="text-center">
            <h1>No malwares where found.</h1>
            <h2>Upload some on the <span>Upload</span> page and then come back.</h2>
          </div>
        </div>
      <% } %>
    </div>

  </div>
</div>

