class Malware < ApplicationRecord
  require 'csv'

  def self.upload(inputFile)
    logger.debug "Now running upload"
    records = CSV.read(inputFile.path)
    records.shift #remove header

  	for r in records
  		malware = Malware.new
  		malware.md5 = r[0]
  		malware.classificationName = r[1]
  		malware.classificationType = r[2]
  		malware.size = r[3]
  		malware.filetype= r[4]

  		#Since we don't have unique identifying information, this 
  		#conditional prevents exact duplicates as a bare minimum form of data checking
  		if(not ((Malware.find_by_md5(malware.md5)) and 
  			(Malware.find_by_classificationName(malware.classificationName)) and
			(Malware.find_by_classificationType(malware.classificationType)) and 
			(Malware.find_by_size(malware.size)) and 
			(Malware.find_by_filetype(malware.filetype))) )
  			malware.save
  		else
  			logger.debug "Found duplicate"
  		end
  	logger.debug "Done with upload"
  end 
end
end
