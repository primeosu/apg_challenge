module MalwareHelper

  # a bootstrap styled input group for file uploads
  def twbs_file_upload
    content_tag(:div, class: 'form-group file-upload') do
      content_tag(:div, class: 'input-group') do
        btn = content_tag(:div, class: 'input-group-btn') do
          content_tag(:div, class: 'btn btn-primary btn-file') do
            text = 'Browse&hellip;'
            file = tag :input, type: 'file', name: 'csv'
            (text + file).html_safe
          end
        end
        input = tag(:input, type: 'text', class: 'form-control', readonly: true)
        (btn + input).html_safe
      end
    end
  end

  # quick and simple bootstrap table with customizable headers.
  def twbs_table(rows)
    if rows.nil? || rows.empty?
      content_tag(:h4, 'Nothing to see yet =(')
    else
      content_tag(:table, class: 'table table-striped') do
        head = content_tag(:thead) do
          content_tag(:tr) do
            (rows.first.keys.map { |key| content_tag(:th, key.to_s.humanize) }).join().html_safe
          end
        end
        body = content_tag(:tbody) do
          (rows.map do |row|
            content_tag(:tr) do
              (row.values.map { |val| content_tag(:td, val) }).join().html_safe
            end
          end).join().html_safe
        end
        (head + body).html_safe
      end
    end
  end
end
