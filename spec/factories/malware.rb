require 'digest'

# seed the random number generator to keep test results predictable.
#  on the chance that two identical hashes are created, or an edge case
#  is revealed, the test will fail the same way with repeated runs
static = Random.new(1337)
dig = Digest::MD5.new

FactoryGirl.define do
  factory :malware do
    classification
    filetype
    size 145082
    md5  '0xA41D8CD98F00B204E9800998ECF8427E'
  end

  # generate random MD5 hashes to make it easy to add an
  # arbitrary number of malware entries to the db
  trait :random_md5 do
    md5 { "0x#{dig.update(static.rand().to_s)}" }
  end

  factory :classification do
    threat_type 'worm'
    behavior    'Backdoor'
  end

  factory :filetype do
    extension 'exe'
  end
end