require 'rails_helper'

describe Malware do

  it { should validate_presence_of(:md5) }
  it { should validate_presence_of(:size) }
  it { should validate_presence_of(:classification) }
  it { should validate_presence_of(:file_type) }

  it { should belong_to(:classification) }
  it { should belong_to(:file_type) }

  it { should delegate_method(:classification_type).to(:classification) }

  it { should validate_numericality_of(:size) }

  it 'should validate size greater than zero' do
    malware = FactoryGirl.build(:malware, size: Faker::Number.between(-9999, 0))

    expect(malware).to_not be_valid
  end

end